{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _View = _interopRequireDefault(require(\"react-native-web/dist/exports/View\"));\n\nvar _StyleSheet = _interopRequireDefault(require(\"react-native-web/dist/exports/StyleSheet\"));\n\nvar _Text = _interopRequireDefault(require(\"react-native-web/dist/exports/Text\"));\n\nvar _Button = _interopRequireDefault(require(\"react-native-web/dist/exports/Button\"));\n\nvar _TouchableOpacity = _interopRequireDefault(require(\"react-native-web/dist/exports/TouchableOpacity\"));\n\nvar _asyncStorage = _interopRequireDefault(require(\"@react-native-community/async-storage\"));\n\nvar _moment = _interopRequireWildcard(require(\"moment\"));\n\nvar _config = require(\"../firebase/config.js\");\n\nvar _navigationRef = require(\"../navigationRef\");\n\nvar _ReelView = _interopRequireDefault(require(\"../components/ReelView\"));\n\nvar _this = this,\n    _jsxFileName = \"/Users/rithikpothuganti/Telescope-app/Telescope/src/screens/ConfirmUploadScreen.js\";\n\nvar ConfirmUploadScreen = function ConfirmUploadScreen(props) {\n  var _props$navigation$sta = props.navigation.state.params,\n      url = _props$navigation$sta.url,\n      tags = _props$navigation$sta.tags,\n      thumbnail = _props$navigation$sta.thumbnail,\n      description = _props$navigation$sta.description,\n      username = _props$navigation$sta.username,\n      uid = _props$navigation$sta.uid;\n\n  var confirmUpload = function confirmUpload() {\n    var reelsRef, usersRef, uid;\n    return _regenerator.default.async(function confirmUpload$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            reelsRef = _config.firebase.firestore().collection(\"reels\");\n            usersRef = _config.firebase.firestore().collection(\"users\");\n            _context.next = 4;\n            return _regenerator.default.awrap(_asyncStorage.default.getItem(\"token\"));\n\n          case 4:\n            uid = _context.sent;\n            _context.next = 7;\n            return _regenerator.default.awrap(usersRef.doc(uid).update({\n              lastUploaded: (0, _moment.default)().unix().valueOf()\n            }));\n\n          case 7:\n            _context.next = 9;\n            return _regenerator.default.awrap(reelsRef.add({\n              timestamp: (0, _moment.default)().unix().valueOf(),\n              daystamp: getDaystamp((0, _moment.default)()),\n              weekstamp: getWeekstamp((0, _moment.default)()),\n              youtube_id: url,\n              tags: tags,\n              user: uid,\n              thumbnail: thumbnail,\n              upvotes: [],\n              comments: [],\n              description: description,\n              num_upvotes: 0\n            }));\n\n          case 9:\n            props.navigation.goBack(null);\n            (0, _navigationRef.navigate)(\"Today\");\n\n          case 11:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  return _react.default.createElement(_react.default.Fragment, null, _react.default.createElement(_ReelView.default, {\n    url: url,\n    tags: tags,\n    username: username,\n    description: description,\n    reel_uid: uid,\n    autoplay: true,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 43,\n      columnNumber: 7\n    }\n  }), _react.default.createElement(_View.default, {\n    style: styles.topBar,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 51,\n      columnNumber: 7\n    }\n  }, _react.default.createElement(_TouchableOpacity.default, {\n    style: {\n      zIndex: 2\n    },\n    onPress: function onPress() {\n      props.navigation.goBack(null);\n    },\n    style: styles.backContainer,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 52,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_Text.default, {\n    style: styles.uploadText,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 11\n    }\n  }, \"Back\")), _react.default.createElement(_TouchableOpacity.default, {\n    style: {\n      zIndex: 2\n    },\n    onPress: function onPress() {\n      confirmUpload();\n    },\n    style: styles.uploadContainer,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_Text.default, {\n    style: styles.uploadText,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 11\n    }\n  }, \"Upload\"))));\n};\n\nvar getDaystamp = function getDaystamp(moment_) {\n  return Math.floor(moment_.unix().valueOf() / 86400);\n};\n\nvar getWeekstamp = function getWeekstamp(moment_) {\n  return Math.floor((Math.floor(moment_.unix().valueOf() / 86400) - 4) / 7);\n};\n\nConfirmUploadScreen.navigationOptions = function () {\n  return {\n    header: function header() {\n      return false;\n    }\n  };\n};\n\nvar styles = _StyleSheet.default.create({\n  topBar: {\n    position: \"absolute\",\n    top: 0,\n    paddingTop: 45,\n    backgroundColor: \"white\",\n    left: 0,\n    width: \"100%\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\"\n  },\n  uploadContainer: {\n    padding: 8,\n    marginRight: 8\n  },\n  backContainer: {\n    padding: 8,\n    marginLeft: 8\n  },\n  uploadText: {\n    color: \"#5C33FF\",\n    fontFamily: \"Raleway-Bold\",\n    fontSize: 18\n  }\n});\n\nvar _default = ConfirmUploadScreen;\nexports.default = _default;","map":{"version":3,"sources":["/Users/rithikpothuganti/Telescope-app/Telescope/src/screens/ConfirmUploadScreen.js"],"names":["ConfirmUploadScreen","props","navigation","state","params","url","tags","thumbnail","description","username","uid","confirmUpload","reelsRef","firebase","firestore","collection","usersRef","AsyncStorage","getItem","doc","update","lastUploaded","unix","valueOf","add","timestamp","daystamp","getDaystamp","weekstamp","getWeekstamp","youtube_id","user","upvotes","comments","num_upvotes","goBack","styles","topBar","zIndex","backContainer","uploadText","uploadContainer","moment_","Math","floor","navigationOptions","header","StyleSheet","create","position","top","paddingTop","backgroundColor","left","width","flexDirection","justifyContent","padding","marginRight","marginLeft","color","fontFamily","fontSize"],"mappings":"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","sourcesContent":["import React, { useState, useCallback, useRef } from \"react\";\nimport { View, StyleSheet, Text, Button, TouchableOpacity } from \"react-native\";\nimport AsyncStorage from \"@react-native-community/async-storage\";\nimport moment, { unix } from \"moment\";\nimport { firebase } from \"../firebase/config.js\";\nimport { navigate } from \"../navigationRef\";\nimport ReelView from \"../components/ReelView\";\n\nconst ConfirmUploadScreen = (props) => {\n  const {\n    url,\n    tags,\n    thumbnail,\n    description,\n    username,\n    uid,\n  } = props.navigation.state.params;\n  const confirmUpload = async () => {\n    const reelsRef = firebase.firestore().collection(\"reels\");\n    const usersRef = firebase.firestore().collection(\"users\");\n\n    const uid = await AsyncStorage.getItem(\"token\");\n    await usersRef.doc(uid).update({ lastUploaded: moment().unix().valueOf() });\n    await reelsRef.add({\n      timestamp: moment().unix().valueOf(),\n      daystamp: getDaystamp(moment()),\n      weekstamp: getWeekstamp(moment()),\n      youtube_id: url,\n      tags,\n      user: uid,\n      thumbnail,\n      upvotes: [],\n      comments: [],\n      description,\n      num_upvotes: 0,\n    });\n    props.navigation.goBack(null);\n    navigate(\"Today\");\n  };\n\n  return (\n    <>\n      <ReelView\n        url={url}\n        tags={tags}\n        username={username}\n        description={description}\n        reel_uid={uid}\n        autoplay={true}\n      />\n      <View style={styles.topBar}>\n        <TouchableOpacity\n          style={{ zIndex: 2 }}\n          onPress={() => {\n            props.navigation.goBack(null);\n          }}\n          style={styles.backContainer}\n        >\n          <Text style={styles.uploadText}>Back</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          style={{ zIndex: 2 }}\n          onPress={() => {\n            confirmUpload();\n          }}\n          style={styles.uploadContainer}\n        >\n          <Text style={styles.uploadText}>Upload</Text>\n        </TouchableOpacity>\n      </View>\n    </>\n  );\n};\n\nconst getDaystamp = (moment_) => {\n  // get unix days since jan 1st 1970\n  return Math.floor(moment_.unix().valueOf() / 86400);\n};\n\nconst getWeekstamp = (moment_) => {\n  // get unix weeks since dec 29 monday 1969\n  return Math.floor((Math.floor(moment_.unix().valueOf() / 86400) - 4) / 7);\n};\n\nConfirmUploadScreen.navigationOptions = () => {\n  return {\n    header: () => false,\n  };\n};\n\nconst styles = StyleSheet.create({\n  topBar: {\n    position: \"absolute\",\n    top: 0,\n    paddingTop: 45,\n    backgroundColor: \"white\",\n    left: 0,\n    width: \"100%\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n  },\n  uploadContainer: {\n    padding: 8,\n    marginRight: 8,\n  },\n  backContainer: {\n    padding: 8,\n    marginLeft: 8,\n  },\n  uploadText: {\n    color: \"#5C33FF\",\n    fontFamily: \"Raleway-Bold\",\n    fontSize: 18,\n  },\n});\n\nexport default ConfirmUploadScreen;\n"]},"metadata":{},"sourceType":"script"}