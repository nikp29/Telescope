{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _asyncStorage = _interopRequireDefault(require(\"@react-native-community/async-storage\"));\n\nvar _config = require(\"../firebase/config.js\");\n\nvar _View = _interopRequireDefault(require(\"react-native-web/dist/exports/View\"));\n\nvar _TouchableOpacity = _interopRequireDefault(require(\"react-native-web/dist/exports/TouchableOpacity\"));\n\nvar _TouchableWithoutFeedback = _interopRequireDefault(require(\"react-native-web/dist/exports/TouchableWithoutFeedback\"));\n\nvar _StyleSheet = _interopRequireDefault(require(\"react-native-web/dist/exports/StyleSheet\"));\n\nvar _ImageBackground = _interopRequireDefault(require(\"react-native-web/dist/exports/ImageBackground\"));\n\nvar _reactNativeElements = require(\"react-native-elements\");\n\nvar _Spacer = _interopRequireDefault(require(\"./Spacer\"));\n\nvar _navigationRef = require(\"../navigationRef\");\n\nvar _FontAwesome = _interopRequireDefault(require(\"@expo/vector-icons/FontAwesome\"));\n\nvar _reactNavigationHooks = require(\"react-navigation-hooks\");\n\nvar _this = this,\n    _jsxFileName = \"/Users/rithikpothuganti/Telescope-app/Telescope/src/components/ReelFeedCard.js\";\n\nvar ReelFeedView = function ReelFeedView(_ref) {\n  var title = _ref.title,\n      image_url = _ref.image_url,\n      youtube_id = _ref.youtube_id,\n      id = _ref.id,\n      data = _ref.data;\n\n  var _useState = (0, _react.useState)(false),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      upvoted = _useState2[0],\n      setUpvoted = _useState2[1];\n\n  var _useState3 = (0, _react.useState)([]),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      upvotes = _useState4[0],\n      setUpvotes = _useState4[1];\n\n  (0, _react.useEffect)(function () {\n    function fetchUid() {\n      var uid, reelsRef;\n      return _regenerator.default.async(function fetchUid$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regenerator.default.awrap(_asyncStorage.default.getItem(\"token\"));\n\n            case 2:\n              uid = _context.sent;\n              reelsRef = _config.firebase.firestore().collection(\"reels\");\n              reelsRef.doc(id).get().then(function (doc) {\n                var data = doc.data();\n                setUpvoted(data.upvotes.includes(uid));\n                setUpvotes(data.upvotes);\n              }).catch(function (error) {\n                return console.log(error.message);\n              });\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n\n    fetchUid();\n    return function () {\n      null;\n    };\n  }, []);\n  return _react.default.createElement(_TouchableOpacity.default, {\n    onPress: function onPress() {\n      (0, _navigationRef.navigate)(\"ReelView\", {\n        data: data,\n        upvoted: upvoted,\n        setUpvoted: setUpvoted,\n        upvotes: upvotes,\n        setUpvotes: setUpvotes,\n        editVote: editVote\n      });\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36,\n      columnNumber: 5\n    }\n  }, _react.default.createElement(_View.default, {\n    style: styles.container,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 48,\n      columnNumber: 7\n    }\n  }, _react.default.createElement(_ImageBackground.default, {\n    source: {\n      uri: image_url\n    },\n    style: styles.image,\n    imageStyle: {\n      borderRadius: 5\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_View.default, {\n    style: {\n      flexDirection: \"column-reverse\",\n      height: \"100%\",\n      alignItems: \"flex-end\",\n      justifyContent: \"flex-start\"\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 11\n    }\n  }, _react.default.createElement(_TouchableWithoutFeedback.default, {\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 13\n    }\n  }, _react.default.createElement(_TouchableOpacity.default, {\n    onPress: function onPress() {\n      return editVote(upvotes, id, setUpvoted);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 15\n    }\n  }, _react.default.createElement(_View.default, {\n    style: styles.upvoteView,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 17\n    }\n  }, _react.default.createElement(_FontAwesome.default, {\n    name: upvoted ? \"heart\" : \"heart-o\",\n    size: 30,\n    color: upvoted ? \"#FFD770\" : \"#999999\",\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 19\n    }\n  }), _react.default.createElement(_reactNativeElements.Text, {\n    style: styles.text,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 19\n    }\n  }, upvotes.length))))))), _react.default.createElement(_Spacer.default, {\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 7\n    }\n  }));\n};\n\nvar editVote = function editVote(upvotes, id, setUpvoted) {\n  var uid, reelsRef, new_upvotes;\n  return _regenerator.default.async(function editVote$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.next = 2;\n          return _regenerator.default.awrap(_asyncStorage.default.getItem(\"token\"));\n\n        case 2:\n          uid = _context2.sent;\n          reelsRef = _config.firebase.firestore().collection(\"reels\");\n          new_upvotes = upvotes;\n\n          if (!upvotes.includes(uid)) {\n            _context2.next = 12;\n            break;\n          }\n\n          new_upvotes.splice(new_upvotes.indexOf(uid), 1);\n          _context2.next = 9;\n          return _regenerator.default.awrap(reelsRef.doc(id).update({\n            upvotes: new_upvotes,\n            num_upvotes: upvotes.length\n          }));\n\n        case 9:\n          setUpvoted(false);\n          _context2.next = 16;\n          break;\n\n        case 12:\n          new_upvotes.push(uid);\n          _context2.next = 15;\n          return _regenerator.default.awrap(reelsRef.doc(id).update({\n            upvotes: new_upvotes,\n            num_upvotes: upvotes.length\n          }));\n\n        case 15:\n          setUpvoted(true);\n\n        case 16:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nvar styles = _StyleSheet.default.create({\n  container: {\n    backgroundColor: \"white\",\n    flexDirection: \"column\",\n    padding: 0\n  },\n  image: {\n    width: \"100%\",\n    aspectRatio: 16 / 9,\n    borderRadius: 5\n  },\n  horizontalContainer: {\n    flexDirection: \"row-reverse\",\n    alignItems: \"center\",\n    height: \"100%\"\n  },\n  name: {\n    fontWeight: \"bold\"\n  },\n  text: {\n    color: \"white\",\n    fontFamily: \"Raleway\"\n  },\n  upvoteView: {\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: 8,\n    borderRadius: 8\n  }\n});\n\nvar _default = ReelFeedView;\nexports.default = _default;","map":{"version":3,"sources":["/Users/rithikpothuganti/Telescope-app/Telescope/src/components/ReelFeedCard.js"],"names":["ReelFeedView","title","image_url","youtube_id","id","data","upvoted","setUpvoted","upvotes","setUpvotes","fetchUid","AsyncStorage","getItem","uid","reelsRef","firebase","firestore","collection","doc","get","then","includes","catch","error","console","log","message","editVote","styles","container","uri","image","borderRadius","flexDirection","height","alignItems","justifyContent","upvoteView","text","length","new_upvotes","splice","indexOf","update","num_upvotes","push","StyleSheet","create","backgroundColor","padding","width","aspectRatio","horizontalContainer","name","fontWeight","color","fontFamily"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport AsyncStorage from \"@react-native-community/async-storage\";\nimport { firebase } from \"../firebase/config.js\";\nimport { View, TouchableOpacity, TouchableWithoutFeedback } from \"react-native\";\nimport { StyleSheet, ImageBackground } from \"react-native\";\nimport { Text, Image } from \"react-native-elements\";\nimport Spacer from \"./Spacer\";\nimport { navigate } from \"../navigationRef\";\nimport Icon from \"react-native-vector-icons/FontAwesome\";\nimport { useFocusEffect } from \"react-navigation-hooks\";\n\nconst ReelFeedView = ({ title, image_url, youtube_id, id, data }) => {\n  const [upvoted, setUpvoted] = useState(false);\n  const [upvotes, setUpvotes] = useState([]);\n\n  useEffect(() => {\n    async function fetchUid() {\n      const uid = await AsyncStorage.getItem(\"token\");\n      const reelsRef = firebase.firestore().collection(\"reels\");\n      reelsRef\n        .doc(id)\n        .get()\n        .then((doc) => {\n          const data = doc.data();\n          setUpvoted(data.upvotes.includes(uid));\n          setUpvotes(data.upvotes);\n        })\n        .catch((error) => console.log(error.message));\n    }\n    fetchUid();\n    return () => {\n      null;\n    };\n  }, []);\n  return (\n    <TouchableOpacity\n      onPress={() => {\n        navigate(\"ReelView\", {\n          data: data,\n          upvoted,\n          setUpvoted,\n          upvotes,\n          setUpvotes,\n          editVote,\n        });\n      }}\n    >\n      <View style={styles.container}>\n        <ImageBackground\n          source={{ uri: image_url }}\n          style={styles.image}\n          imageStyle={{ borderRadius: 5 }}\n        >\n          <View\n            style={{\n              flexDirection: \"column-reverse\",\n              height: \"100%\",\n              alignItems: \"flex-end\",\n              justifyContent: \"flex-start\",\n            }}\n          >\n            <TouchableWithoutFeedback>\n              <TouchableOpacity\n                onPress={() => editVote(upvotes, id, setUpvoted)}\n              >\n                <View style={styles.upvoteView}>\n                  <Icon\n                    name={upvoted ? \"heart\" : \"heart-o\"}\n                    size={30}\n                    color={upvoted ? \"#FFD770\" : \"#999999\"}\n                  />\n                  <Text style={styles.text}>{upvotes.length}</Text>\n                </View>\n              </TouchableOpacity>\n            </TouchableWithoutFeedback>\n          </View>\n        </ImageBackground>\n      </View>\n      <Spacer />\n    </TouchableOpacity>\n  );\n};\n\nconst editVote = async (upvotes, id, setUpvoted) => {\n  const uid = await AsyncStorage.getItem(\"token\");\n  const reelsRef = firebase.firestore().collection(\"reels\");\n\n  let new_upvotes = upvotes;\n  if (upvotes.includes(uid)) {\n    new_upvotes.splice(new_upvotes.indexOf(uid), 1);\n    await reelsRef\n      .doc(id)\n      .update({ upvotes: new_upvotes, num_upvotes: upvotes.length });\n    setUpvoted(false);\n  } else {\n    // reel has not already been upvoted\n    new_upvotes.push(uid);\n    await reelsRef\n      .doc(id)\n      .update({ upvotes: new_upvotes, num_upvotes: upvotes.length });\n    setUpvoted(true);\n  }\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    backgroundColor: \"white\",\n    flexDirection: \"column\",\n    padding: 0,\n    // borderRadius: 10,\n  },\n  image: {\n    width: \"100%\",\n    aspectRatio: 16 / 9,\n    // height: null,\n    // width: 100,\n    // width: null,\n    // flex: 1,\n    borderRadius: 5,\n  },\n  horizontalContainer: {\n    flexDirection: \"row-reverse\",\n    alignItems: \"center\",\n    height: \"100%\",\n  },\n  name: {\n    fontWeight: \"bold\",\n  },\n  text: {\n    color: \"white\",\n    fontFamily: \"Raleway\",\n  },\n  upvoteView: {\n    flexDirection: \"column\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    padding: 8,\n    // borderColor: \"#FFD770\",\n    // borderWidth: 1,\n    borderRadius: 8,\n  },\n});\nexport default ReelFeedView;\n"]},"metadata":{},"sourceType":"script"}