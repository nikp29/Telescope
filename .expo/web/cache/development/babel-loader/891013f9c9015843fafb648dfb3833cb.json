{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _FlatList = _interopRequireDefault(require(\"react-native-web/dist/exports/FlatList\"));\n\nvar _View = _interopRequireDefault(require(\"react-native-web/dist/exports/View\"));\n\nvar _StyleSheet = _interopRequireDefault(require(\"react-native-web/dist/exports/StyleSheet\"));\n\nvar _Text = _interopRequireDefault(require(\"react-native-web/dist/exports/Text\"));\n\nvar _TouchableOpacity = _interopRequireDefault(require(\"react-native-web/dist/exports/TouchableOpacity\"));\n\nvar _ScrollView = _interopRequireDefault(require(\"react-native-web/dist/exports/ScrollView\"));\n\nrequire(\"react-native-gesture-handler\");\n\nvar _expoFont = require(\"expo-font\");\n\nvar _reactNavigation = require(\"react-navigation\");\n\nvar _Spacer = _interopRequireDefault(require(\"../components/Spacer\"));\n\nvar _config = require(\"../firebase/config.js\");\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _ReelFeedCard = _interopRequireDefault(require(\"../components/ReelFeedCard\"));\n\nvar _navigationRef = require(\"../navigationRef\");\n\nvar _FontAwesome = _interopRequireDefault(require(\"@expo/vector-icons/FontAwesome\"));\n\nvar _this = this,\n    _jsxFileName = \"/Users/rithikpothuganti/Telescope-app/Telescope/src/screens/FeedScreen.js\";\n\nvar ReelScreen = function ReelScreen(props) {\n  var _useState = (0, _react.useState)(true),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      isWeek = _useState2[0],\n      setIsWeek = _useState2[1];\n\n  var _useState3 = (0, _react.useState)(false),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      initialGet = _useState4[0],\n      setInitialGet = _useState4[1];\n\n  var _useFonts = (0, _expoFont.useFonts)({\n    Raleway: require(\"../../assets/Raleway-Bold.ttf\"),\n    RalewayExtraBold: require(\"../../assets/Raleway-ExtraBold.ttf\")\n  }),\n      _useFonts2 = (0, _slicedToArray2.default)(_useFonts, 1),\n      loaded = _useFonts2[0];\n\n  var _useState5 = (0, _react.useState)([]),\n      _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n      reelList = _useState6[0],\n      setReelList = _useState6[1];\n\n  if (initialGet == false) {\n    setInitialGet(true);\n    getReelList(setReelList, 3, true);\n  }\n\n  if (!loaded) {\n    return null;\n  }\n\n  return _react.default.createElement(_react.default.Fragment, null, _react.default.createElement(_reactNavigation.NavigationEvents, {\n    onWillFocus: function onWillFocus(payload) {\n      return getReelList(setReelList, 3, true);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 38,\n      columnNumber: 7\n    }\n  }), _react.default.createElement(_View.default, {\n    style: styles.tabBar,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 41,\n      columnNumber: 7\n    }\n  }, _react.default.createElement(_TouchableOpacity.default, {\n    onPress: function _callee(event) {\n      return _regenerator.default.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              (0, _navigationRef.navigate)(\"Today\");\n\n            case 1:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 42,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_Text.default, {\n    style: isWeek ? styles.tab : styles.tabActive,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 47,\n      columnNumber: 11\n    }\n  }, \"Explore\")), _react.default.createElement(_TouchableOpacity.default, {\n    onPress: function _callee2(event) {\n      return _regenerator.default.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_Text.default, {\n    style: isWeek ? styles.tabActive : styles.tab,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 50,\n      columnNumber: 11\n    }\n  }, \"Leaderboard\")), _react.default.createElement(_TouchableOpacity.default, {\n    style: {\n      marginTop: 5\n    },\n    onPress: function onPress(event) {\n      (0, _navigationRef.navigate)(\"Search\");\n    },\n    onSwiped: function onSwiped(cardIndex) {\n      setCurrent(cardIndex);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_FontAwesome.default, {\n    name: \"search\",\n    size: 25,\n    color: \"#ccc0ff\",\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 11\n    }\n  }))), _react.default.createElement(_ScrollView.default, {\n    style: {\n      backgroundColor: \"white\"\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, _react.default.createElement(_Spacer.default, {\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, reelList.length != 0 ? _react.default.createElement(_Text.default, {\n    style: styles.header,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 13\n    }\n  }, \"Top 3\") : null, _react.default.createElement(_FlatList.default, {\n    showsVerticalScrollIndicator: false,\n    data: reelList.slice(0, reelList.length >= 3 ? 3 : reelList.length),\n    keyExtractor: function keyExtractor(data) {\n      return data.id;\n    },\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item;\n      return renderReelFeedView(item);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  }), reelList.length > 3 ? _react.default.createElement(_View.default, {\n    style: {\n      borderBottomColor: \"black\",\n      borderBottomWidth: 1,\n      marginBottom: 32\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 13\n    }\n  }) : null, _react.default.createElement(_FlatList.default, {\n    showsVerticalScrollIndicator: false,\n    data: reelList.slice(reelList.length >= 3 ? 3 : reelList.length),\n    keyExtractor: function keyExtractor(data) {\n      return data.id;\n    },\n    renderItem: function renderItem(_ref2) {\n      var item = _ref2.item;\n      return renderReelFeedView(item);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  }))));\n};\n\nReelScreen.navigationOptions = function () {\n  return {\n    header: function header() {\n      return false;\n    }\n  };\n};\n\nvar getReelList = function getReelList(setReelList, numDisplayed, isWeek) {\n  var reelsRef, reelList_;\n  return _regenerator.default.async(function getReelList$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          reelsRef = _config.firebase.firestore().collection(\"reels\");\n          reelList_ = [];\n\n          if (isWeek) {\n            reelsRef.orderBy(\"num_upvotes\", \"desc\").where(\"weekstamp\", \"==\", getWeekstamp((0, _moment.default)())).orderBy(\"timestamp\", \"desc\").limit(numDisplayed).get().then(function (querySnapshot) {\n              querySnapshot.forEach(function (doc) {\n                var data_ = doc.data();\n                data_[\"id\"] = doc.id;\n                reelList_.push(data_);\n              });\n              setReelList(reelList_);\n            }).catch(function (error) {\n              console.log(error.message);\n            });\n          } else {\n            reelsRef.orderBy(\"upvotes\", \"desc\").where(\"daystamp\", \"==\", getDaystamp((0, _moment.default)())).orderBy(\"timestamp\", \"desc\").limit(numDisplayed).get().then(function (querySnapshot) {\n              querySnapshot.forEach(function (doc) {\n                var data_ = doc.data();\n                data_[\"id\"] = doc.id;\n                reelList_.push(data_);\n              });\n              setReelList(reelList_);\n            }).catch(function (error) {\n              console.log(error.message);\n            });\n          }\n\n        case 3:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nvar getDaystamp = function getDaystamp(moment_) {\n  return Math.floor(moment_.unix().valueOf() / 86400);\n};\n\nvar getWeekstamp = function getWeekstamp(moment_) {\n  return Math.floor((Math.floor(moment_.unix().valueOf() / 86400) - 4) / 7);\n};\n\nvar renderReelFeedView = function renderReelFeedView(data) {\n  return _react.default.createElement(_ReelFeedCard.default, {\n    title: data.title,\n    upvotes: data.upvotes,\n    image_url: data.thumbnail,\n    id: data.id,\n    data: data,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 5\n    }\n  });\n};\n\nvar styles = _StyleSheet.default.create({\n  tabBar: {\n    paddingHorizontal: 16,\n    flexDirection: \"row\",\n    paddingTop: 60,\n    justifyContent: \"space-around\",\n    opacity: 50,\n    backgroundColor: \"white\",\n    paddingBottom: 8\n  },\n  tab: {\n    fontFamily: \"Raleway-Bold\",\n    fontWeight: \"400\",\n    fontSize: 25,\n    color: \"#ccc0ff\"\n  },\n  tabActive: {\n    fontFamily: \"Raleway-Bold\",\n    fontWeight: \"400\",\n    fontSize: 25,\n    color: \"#5c33ff\"\n  },\n  header: {\n    fontSize: 30,\n    fontFamily: \"RalewayExtraBold\",\n    marginBottom: 16\n  }\n});\n\nvar _default = ReelScreen;\nexports.default = _default;","map":{"version":3,"sources":["/Users/rithikpothuganti/Telescope-app/Telescope/src/screens/FeedScreen.js"],"names":["ReelScreen","props","isWeek","setIsWeek","initialGet","setInitialGet","Raleway","require","RalewayExtraBold","loaded","reelList","setReelList","getReelList","payload","styles","tabBar","event","tab","tabActive","marginTop","cardIndex","setCurrent","backgroundColor","length","header","slice","data","id","item","renderReelFeedView","borderBottomColor","borderBottomWidth","marginBottom","navigationOptions","numDisplayed","reelsRef","firebase","firestore","collection","reelList_","orderBy","where","getWeekstamp","limit","get","then","querySnapshot","forEach","doc","data_","push","catch","error","console","log","message","getDaystamp","moment_","Math","floor","unix","valueOf","title","upvotes","thumbnail","StyleSheet","create","paddingHorizontal","flexDirection","paddingTop","justifyContent","opacity","paddingBottom","fontFamily","fontWeight","fontSize","color"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport {\n  FlatList,\n  View,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  ScrollView,\n} from \"react-native\";\nimport \"react-native-gesture-handler\";\nimport { useFonts } from \"expo-font\";\nimport { NavigationEvents } from \"react-navigation\";\nimport Spacer from \"../components/Spacer\";\nimport { firebase } from \"../firebase/config.js\";\nimport moment from \"moment\";\nimport ReelFeedCard from \"../components/ReelFeedCard\";\nimport { navigate } from \"../navigationRef\";\nimport Icon from \"react-native-vector-icons/FontAwesome\";\n\nconst ReelScreen = (props) => {\n  const [isWeek, setIsWeek] = useState(true);\n  const [initialGet, setInitialGet] = useState(false);\n  const [loaded] = useFonts({\n    Raleway: require(\"../../assets/Raleway-Bold.ttf\"),\n    RalewayExtraBold: require(\"../../assets/Raleway-ExtraBold.ttf\"),\n  });\n  const [reelList, setReelList] = useState([]);\n\n  if (initialGet == false) {\n    setInitialGet(true);\n    getReelList(setReelList, 3, true);\n  }\n  if (!loaded) {\n    return null;\n  }\n  return (\n    <>\n      <NavigationEvents\n        onWillFocus={(payload) => getReelList(setReelList, 3, true)}\n      />\n      <View style={styles.tabBar}>\n        <TouchableOpacity\n          onPress={async (event) => {\n            navigate(\"Today\");\n          }}\n        >\n          <Text style={isWeek ? styles.tab : styles.tabActive}>Explore</Text>\n        </TouchableOpacity>\n        <TouchableOpacity onPress={async (event) => {}}>\n          <Text style={isWeek ? styles.tabActive : styles.tab}>\n            Leaderboard\n          </Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n        style={{marginTop: 5}}\n          onPress={(event) => {\n            navigate(\"Search\");\n          }}\n          onSwiped={(cardIndex) => {\n            setCurrent(cardIndex);\n          }}\n        >\n          <Icon\n            name={\"search\"}\n            size={25}\n            color={ \"#ccc0ff\"}\n          />\n        </TouchableOpacity>\n      </View>\n      <ScrollView style={{ backgroundColor: \"white\" }}>\n        <Spacer>\n          {reelList.length != 0 ? (\n            <Text style={styles.header}>Top 3</Text>\n          ) : null}\n\n          <FlatList\n            showsVerticalScrollIndicator={false}\n            data={reelList.slice(0, reelList.length >= 3 ? 3 : reelList.length)}\n            keyExtractor={(data) => data.id}\n            renderItem={({ item }) => {\n              return renderReelFeedView(item);\n            }}\n          />\n          {reelList.length > 3 ? (\n            <View\n              style={{\n                borderBottomColor: \"black\",\n                borderBottomWidth: 1,\n                marginBottom: 32,\n              }}\n            />\n          ) : null}\n          <FlatList\n            showsVerticalScrollIndicator={false}\n            data={reelList.slice(reelList.length >= 3 ? 3 : reelList.length)}\n            keyExtractor={(data) => data.id}\n            renderItem={({ item }) => {\n              return renderReelFeedView(item);\n            }}\n          />\n        </Spacer>\n      </ScrollView>\n    </>\n  );\n};\n\nReelScreen.navigationOptions = () => {\n  return {\n    header: () => false,\n  };\n};\n\nconst getReelList = async (setReelList, numDisplayed, isWeek) => {\n  let reelsRef = firebase.firestore().collection(\"reels\");\n  let reelList_ = [];\n  if (isWeek) {\n    reelsRef\n      .orderBy(\"num_upvotes\", \"desc\")\n      .where(\"weekstamp\", \"==\", getWeekstamp(moment()))\n      .orderBy(\"timestamp\", \"desc\")\n      .limit(numDisplayed)\n      .get()\n      .then((querySnapshot) => {\n        querySnapshot.forEach((doc) => {\n          let data_ = doc.data();\n          data_[\"id\"] = doc.id;\n          reelList_.push(data_);\n        });\n        setReelList(reelList_);\n      })\n      .catch((error) => {\n        console.log(error.message);\n      });\n  } else {\n    reelsRef\n      .orderBy(\"upvotes\", \"desc\")\n      .where(\"daystamp\", \"==\", getDaystamp(moment()))\n      .orderBy(\"timestamp\", \"desc\")\n      .limit(numDisplayed)\n      .get()\n      .then((querySnapshot) => {\n        querySnapshot.forEach((doc) => {\n          let data_ = doc.data();\n          data_[\"id\"] = doc.id;\n          reelList_.push(data_);\n        });\n        setReelList(reelList_);\n      })\n      .catch((error) => {\n        console.log(error.message);\n      });\n  }\n};\n\nconst getDaystamp = (moment_) => {\n  // get unix days since jan 1st 1970\n  return Math.floor(moment_.unix().valueOf() / 86400);\n};\n\nconst getWeekstamp = (moment_) => {\n  // get unix weeks since dec 29 monday 1969\n  return Math.floor((Math.floor(moment_.unix().valueOf() / 86400) - 4) / 7);\n};\n\nconst renderReelFeedView = (data) => {\n  return (\n    <ReelFeedCard\n      title={data.title}\n      upvotes={data.upvotes}\n      image_url={data.thumbnail}\n      id={data.id}\n      data={data}\n    />\n  );\n};\n\nconst styles = StyleSheet.create({\n  tabBar: {\n    paddingHorizontal: 16,\n    flexDirection: \"row\",\n    paddingTop: 60,\n    justifyContent: \"space-around\",\n    opacity: 50,\n    backgroundColor: \"white\",\n    paddingBottom: 8,\n  },\n  tab: {\n    fontFamily: \"Raleway-Bold\",\n    fontWeight: \"400\",\n    fontSize: 25,\n    color: \"#ccc0ff\",\n  },\n  tabActive: {\n    fontFamily: \"Raleway-Bold\",\n    fontWeight: \"400\",\n    fontSize: 25,\n    color: \"#5c33ff\",\n  },\n  header: {\n    fontSize: 30,\n    fontFamily: \"RalewayExtraBold\",\n    marginBottom: 16,\n  },\n});\n\nexport default ReelScreen;\n"]},"metadata":{},"sourceType":"script"}