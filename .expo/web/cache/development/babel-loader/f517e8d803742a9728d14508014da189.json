{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _interopRequireWildcard = require(\"@babel/runtime/helpers/interopRequireWildcard\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _slicedToArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/slicedToArray\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _View = _interopRequireDefault(require(\"react-native-web/dist/exports/View\"));\n\nvar _ScrollView = _interopRequireDefault(require(\"react-native-web/dist/exports/ScrollView\"));\n\nvar _StyleSheet = _interopRequireDefault(require(\"react-native-web/dist/exports/StyleSheet\"));\n\nvar _Text = _interopRequireDefault(require(\"react-native-web/dist/exports/Text\"));\n\nvar _TouchableOpacity = _interopRequireDefault(require(\"react-native-web/dist/exports/TouchableOpacity\"));\n\nvar _Dimensions = _interopRequireDefault(require(\"react-native-web/dist/exports/Dimensions\"));\n\nvar _Platform = _interopRequireDefault(require(\"react-native-web/dist/exports/Platform\"));\n\nvar _Image = _interopRequireDefault(require(\"react-native-web/dist/exports/Image\"));\n\nvar _Animated = _interopRequireDefault(require(\"react-native-web/dist/exports/Animated\"));\n\nvar _reactNavigation = require(\"react-navigation\");\n\nvar _ReelView = _interopRequireDefault(require(\"../components/ReelView\"));\n\nvar _navigationRef = require(\"../navigationRef\");\n\nvar _config = require(\"../firebase/config.js\");\n\nvar _shuffleArray = _interopRequireDefault(require(\"shuffle-array\"));\n\nvar _reactNativeSnapCarousel = _interopRequireDefault(require(\"react-native-snap-carousel\"));\n\nvar _moment = _interopRequireDefault(require(\"moment\"));\n\nvar _expoFont = require(\"expo-font\");\n\nvar _FontAwesome = _interopRequireDefault(require(\"@expo/vector-icons/FontAwesome\"));\n\nvar _this = this,\n    _jsxFileName = \"/Users/rithikpothuganti/Telescope-app/Telescope/src/screens/ExploreFeed.js\";\n\nvar ExploreFeed = function ExploreFeed() {\n  var _useState = (0, _react.useState)(0),\n      _useState2 = (0, _slicedToArray2.default)(_useState, 2),\n      current = _useState2[0],\n      setCurrent = _useState2[1];\n\n  var _useState3 = (0, _react.useState)([]),\n      _useState4 = (0, _slicedToArray2.default)(_useState3, 2),\n      reelList = _useState4[0],\n      setReelList = _useState4[1];\n\n  var _useState5 = (0, _react.useState)(true),\n      _useState6 = (0, _slicedToArray2.default)(_useState5, 2),\n      isLoading = _useState6[0],\n      setLoading = _useState6[1];\n\n  var caroselRef = (0, _react.useRef)(null);\n\n  var _useFonts = (0, _expoFont.useFonts)({\n    Raleway: require(\"../../assets/Raleway-Bold.ttf\"),\n    RalewayExtraBold: require(\"../../assets/Raleway-ExtraBold.ttf\")\n  }),\n      _useFonts2 = (0, _slicedToArray2.default)(_useFonts, 1),\n      loaded = _useFonts2[0];\n\n  (0, _react.useEffect)(function () {\n    getReels(setReelList, setLoading);\n    return function () {\n      null;\n    };\n  }, []);\n  var display_array = [];\n\n  if (reelList.length != 0) {\n    display_array = reelList.slice(current == 0 ? 0 : current - 1, current + 1 == reelList.length ? reelList.length : current + 1);\n  }\n\n  if (!loaded) {\n    return null;\n  }\n\n  var height = _Dimensions.default.get(\"window\").height;\n\n  return _react.default.createElement(_View.default, {\n    style: styles.container,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }\n  }, _react.default.createElement(_reactNavigation.NavigationEvents, {\n    onWillFocus: function onWillFocus(payload) {\n      return getReels(setReelList);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 7\n    }\n  }), _react.default.createElement(_reactNativeSnapCarousel.default, {\n    style: {\n      backgroundColor: \"black\"\n    },\n    layout: \"default\",\n    ref: caroselRef,\n    data: reelList,\n    sliderHeight: _Platform.default.OS === \"ios\" ? height - 82 : height - 20,\n    sliderWidth: _Dimensions.default.get(\"window\").width,\n    itemWidth: _Dimensions.default.get(\"window\").width,\n    itemHeight: _Platform.default.OS === \"ios\" ? height - 82 : height - 20,\n    vertical: true,\n    renderItem: function renderItem(_ref) {\n      var item = _ref.item,\n          index = _ref.index;\n      return _react.default.createElement(_View.default, {\n        style: {\n          height: _Platform.default.OS === \"ios\" ? height - 82 : height - 20,\n          backgroundColor: \"black\",\n          width: _Dimensions.default.get(\"window\").width\n        },\n        __self: _this,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 13\n        }\n      }, _react.default.createElement(_ReelView.default, {\n        url: item.youtube_id,\n        tags: item.tags,\n        description: item.description,\n        reel_uid: item.user,\n        id: item.id,\n        showComments: true,\n        height: _Platform.default.OS === \"ios\" ? height - 82 : height - 20,\n        autoplay: index == current,\n        __self: _this,\n        __self: _this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 15\n        }\n      }));\n    },\n    onSnapToItem: function onSnapToItem(index) {\n      return setCurrent(index);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61,\n      columnNumber: 7\n    }\n  }), _react.default.createElement(_View.default, {\n    style: styles.tabBar,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }\n  }, _react.default.createElement(_TouchableOpacity.default, {\n    onPress: function onPress(event) {},\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_Text.default, {\n    style: styles.tabActive,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 11\n    }\n  }, \"Explore\")), _react.default.createElement(_TouchableOpacity.default, {\n    onPress: function onPress(event) {\n      (0, _navigationRef.navigate)(\"ThisWeek\");\n    },\n    onSwiped: function onSwiped(cardIndex) {\n      setCurrent(cardIndex);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_Text.default, {\n    style: styles.tab,\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 11\n    }\n  }, \"Leaderboard\")), _react.default.createElement(_TouchableOpacity.default, {\n    style: {\n      marginTop: 5\n    },\n    onPress: function onPress(event) {\n      (0, _navigationRef.navigate)(\"Search\");\n    },\n    onSwiped: function onSwiped(cardIndex) {\n      setCurrent(cardIndex);\n    },\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 9\n    }\n  }, _react.default.createElement(_FontAwesome.default, {\n    name: \"search\",\n    size: 25,\n    color: \"rgba(255, 255, 255, 0.3)\",\n    __self: _this,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 11\n    }\n  }))));\n};\n\nvar getReels = function getReels(setReelList, setLoading) {\n  var reelsRef, reelList_;\n  return _regenerator.default.async(function getReels$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          reelsRef = _config.firebase.firestore().collection(\"reels\");\n          reelList_ = [];\n          _context.next = 4;\n          return _regenerator.default.awrap(reelsRef.orderBy(\"num_upvotes\", \"desc\").where(\"daystamp\", \"==\", getDaystamp((0, _moment.default)())).orderBy(\"timestamp\", \"desc\").get().then(function (querySnapshot) {\n            querySnapshot.forEach(function (doc) {\n              var data_ = doc.data();\n              data_[\"id\"] = doc.id;\n              reelList_.push(data_);\n            });\n            setReelList((0, _shuffleArray.default)(reelList_));\n            setLoading(false);\n          }).catch(function (error) {\n            console.log(error.message);\n          }));\n\n        case 4:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nvar getDaystamp = function getDaystamp(moment_) {\n  return Math.floor(moment_.unix().valueOf() / 86400);\n};\n\nExploreFeed.navigationOptions = function () {\n  return {\n    header: function header() {\n      return false;\n    }\n  };\n};\n\nvar styles = _StyleSheet.default.create({\n  container: {\n    justifyContent: \"center\",\n    height: \"100%\",\n    backgroundColor: \"black\",\n    flexDirection: \"column\",\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  tabBar: {\n    position: \"absolute\",\n    top: 0,\n    width: \"100%\",\n    paddingHorizontal: 16,\n    flexDirection: \"row\",\n    paddingTop: 60,\n    justifyContent: \"space-around\",\n    opacity: 50,\n    backgroundColor: \"rgba(0,0,0,0)\",\n    paddingBottom: 8\n  },\n  tab: {\n    fontFamily: \"Raleway-Bold\",\n    fontSize: 25,\n    color: \"rgba(255, 255, 255, 0.3)\"\n  },\n  tabActive: {\n    fontFamily: \"Raleway-Bold\",\n    fontSize: 25,\n    color: \"white\"\n  }\n});\n\nvar _default = ExploreFeed;\nexports.default = _default;","map":{"version":3,"sources":["/Users/rithikpothuganti/Telescope-app/Telescope/src/screens/ExploreFeed.js"],"names":["ExploreFeed","current","setCurrent","reelList","setReelList","isLoading","setLoading","caroselRef","Raleway","require","RalewayExtraBold","loaded","getReels","display_array","length","slice","height","Dimensions","get","styles","container","payload","backgroundColor","Platform","OS","width","item","index","youtube_id","tags","description","user","id","tabBar","event","tabActive","cardIndex","tab","marginTop","reelsRef","firebase","firestore","collection","reelList_","orderBy","where","getDaystamp","then","querySnapshot","forEach","doc","data_","data","push","catch","error","console","log","message","moment_","Math","floor","unix","valueOf","navigationOptions","header","StyleSheet","create","justifyContent","flexDirection","alignItems","position","top","paddingHorizontal","paddingTop","opacity","paddingBottom","fontFamily","fontSize","color"],"mappings":"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","sourcesContent":["import React, { useContext, useState, useEffect, useRef } from \"react\";\nimport {\n  View,\n  ScrollView,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  Dimensions,\n  Platform,\n  Image,\n  Animated\n} from \"react-native\";\nimport { NavigationEvents } from \"react-navigation\";\nimport ReelView from \"../components/ReelView\";\nimport { navigate } from \"../navigationRef\";\nimport { firebase } from \"../firebase/config.js\";\nimport shuffle from \"shuffle-array\";\nimport Carousel from \"react-native-snap-carousel\";\nimport moment from \"moment\";\nimport { useFonts } from \"expo-font\";\nimport Icon from \"react-native-vector-icons/FontAwesome\";\n\nconst ExploreFeed = () => {\n  const [current, setCurrent] = useState(0);\n  const [reelList, setReelList] = useState([]);\n  const [isLoading, setLoading] = useState(true);\n  const caroselRef = useRef(null);\n  const [loaded] = useFonts({\n    Raleway: require(\"../../assets/Raleway-Bold.ttf\"),\n    RalewayExtraBold: require(\"../../assets/Raleway-ExtraBold.ttf\"),\n  });\n  useEffect(() => {\n    getReels(setReelList, setLoading);\n    return () => {\n      null;\n    };\n  }, []);\n  let display_array = [];\n  if (reelList.length != 0) {\n    display_array = reelList.slice(\n      current == 0 ? 0 : current - 1,\n      current + 1 == reelList.length ? reelList.length : current + 1\n    );\n  }\n  if (!loaded) {\n    return null;\n  }\n  const height = Dimensions.get(\"window\").height;\n  // if(isLoading) {\n  //   return <Image \n  //   style={{\n  //     width: \"100%\",\n  //     height: \"100%\",\n  //   }}\n  //     source={require(\"../../assets/icons/loading.gif\")}\n  //   ></Image>\n  // }\n  return (\n    <View style={styles.container}>\n      <NavigationEvents onWillFocus={(payload) => getReels(setReelList)} />\n      <Carousel\n        style={{ backgroundColor: \"black\" }}\n        layout={\"default\"}\n        ref={caroselRef}\n        data={reelList}\n        sliderHeight={Platform.OS === \"ios\" ? height - 82 : height - 20}\n        sliderWidth={Dimensions.get(\"window\").width}\n        itemWidth={Dimensions.get(\"window\").width}\n        itemHeight={Platform.OS === \"ios\" ? height - 82 : height - 20}\n        vertical={true}\n        renderItem={({ item, index }) => {\n          return (\n            <View\n              style={{\n                height: Platform.OS === \"ios\" ? height - 82 : height - 20,\n                backgroundColor: \"black\",\n                width: Dimensions.get(\"window\").width,\n              }}\n            >\n              <ReelView\n                url={item.youtube_id}\n                tags={item.tags}\n                description={item.description}\n                reel_uid={item.user}\n                id={item.id}\n                showComments={true}\n                height={Platform.OS === \"ios\" ? height - 82 : height - 20}\n                autoplay={index == current}\n              />\n            </View>\n          );\n        }}\n        onSnapToItem={(index) => setCurrent(index)}\n      />\n      <View style={styles.tabBar}>\n        <TouchableOpacity onPress={(event) => {}}>\n          <Text style={styles.tabActive}>Explore</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n          onPress={(event) => {\n            navigate(\"ThisWeek\");\n          }}\n          onSwiped={(cardIndex) => {\n            setCurrent(cardIndex);\n          }}\n        >\n          <Text style={styles.tab}>Leaderboard</Text>\n        </TouchableOpacity>\n        <TouchableOpacity\n        style={{marginTop: 5}}\n          onPress={(event) => {\n            navigate(\"Search\");\n          }}\n          onSwiped={(cardIndex) => {\n            setCurrent(cardIndex);\n          }}\n        >\n          <Icon\n            name={\"search\"}\n            size={25}\n            color={ \"rgba(255, 255, 255, 0.3)\"}\n          />\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n};\n\nconst getReels = async (setReelList, setLoading) => {\n  let reelsRef = firebase.firestore().collection(\"reels\");\n  let reelList_ = [];\n  await reelsRef\n    .orderBy(\"num_upvotes\", \"desc\")\n    .where(\"daystamp\", \"==\", getDaystamp(moment()))\n    .orderBy(\"timestamp\", \"desc\")\n    .get()\n    .then((querySnapshot) => {\n      querySnapshot.forEach((doc) => {\n        let data_ = doc.data();\n        data_[\"id\"] = doc.id;\n        reelList_.push(data_);\n      });\n      setReelList(shuffle(reelList_));\n        setLoading(false);\n    })\n    .catch((error) => {\n      console.log(error.message);\n    });\n};\n\nconst getDaystamp = (moment_) => {\n  // get unix days since jan 1st 1970\n  return Math.floor(moment_.unix().valueOf() / 86400);\n};\n\nExploreFeed.navigationOptions = () => {\n  return {\n    header: () => false,\n  };\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    justifyContent: \"center\",\n    height: \"100%\",\n    backgroundColor: \"black\",\n    flexDirection: \"column\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  tabBar: {\n    position: \"absolute\",\n    top: 0,\n    width: \"100%\",\n    paddingHorizontal: 16,\n    flexDirection: \"row\",\n    paddingTop: 60,\n    justifyContent: \"space-around\",\n    opacity: 50,\n    backgroundColor: \"rgba(0,0,0,0)\",\n    paddingBottom: 8,\n  },\n  tab: {\n    fontFamily: \"Raleway-Bold\",\n    fontSize: 25,\n    color: \"rgba(255, 255, 255, 0.3)\",\n  },\n  tabActive: {\n    fontFamily: \"Raleway-Bold\",\n    fontSize: 25,\n    color: \"white\",\n  },\n});\n\nexport default ExploreFeed;\n"]},"metadata":{},"sourceType":"script"}